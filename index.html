<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>StudySky</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.20.15/babel.min.js"></script>
  <style>
    body {
      background-color: #f3f4f6;
      color: #111827;
      min-height: 100vh;
      font-family: Arial, sans-serif;
      margin: 0;
    }
    .container {
      background: linear-gradient(to right, #1E3A8A, #3B82F6);
      color: white;
      min-height: 100vh;
      padding: 16px;
    }
    .header {
      position: sticky;
      top: 0;
      background-color: rgba(31, 41, 55, 0.8);
      padding: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .header h1 {
      font-size: 1.5rem;
      font-weight: bold;
    }
    .header button {
      color: white;
      font-weight: bold;
      background: none;
      border: none;
      cursor: pointer;
    }
    .header button:hover {
      text-decoration: underline;
    }
    .subject-title {
      font-size: 1.75rem;
      font-weight: 600;
      margin-top: 16px;
    }
    .total-hours {
      margin-top: 8px;
    }
    .paper-section {
      margin-top: 16px;
    }
    .paper-title {
      font-size: 1.25rem;
      font-weight: 600;
    }
    .chapter-card {
      background-color: white;
      color: #111827;
      border-radius: 8px;
      padding: 16px;
      margin-top: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .chapter-title {
      font-weight: 600;
    }
    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 8px;
    }
    .hours-input {
      width: 80px;
      padding: 8px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      color: #111827;
    }
    .hours-section {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 16px;
    }
    .menu-button {
      display: block;
    }
    .menu-content {
      background-color: #1f2937;
      padding: 16px;
    }
    .reset-button {
      background-color: #dc2626;
      color: white;
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
    }
    .reset-button:hover {
      background-color: #b91c1c;
    }
    .subject-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      margin-top: 16px;
    }
    .subject-card {
      background-color: white;
      color: #111827;
      border-radius: 8px;
      padding: 16px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      cursor: pointer;
    }
    .subject-card:hover {
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .subject-card h2 {
      font-size: 1.25rem;
      font-weight: 600;
    }
    .progress-bar {
      background-color: #e5e7eb;
      border-radius: 9999px;
      overflow: hidden;
      height: 16px;
      margin-top: 8px;
    }
    .progress-fill {
      height: 100%;
      transition: width 0.3s ease;
      background: linear-gradient(to right, #1E3A8A, #3B82F6);
    }
    @media (min-width: 768px) {
      .subject-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      .menu-button {
        display: none;
      }
      .desktop-buttons {
        display: flex;
        gap: 16px;
      }
    }
    @media (min-width: 1024px) {
      .subject-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    // Subject and chapter configuration
    const subjects = [
      {
        name: "Biology",
        papers: [
          { name: "1st Paper", chapters: Array.from({ length: 12 }, (_, i) => `Chapter ${i + 1}`) },
          { name: "2nd Paper", chapters: Array.from({ length: 12 }, (_, i) => `Chapter ${i + 1}`) },
        ],
        methods: ["Watch video", "Read books", "Take notes", "Solve typewise questions", "Read medical guide"],
      },
      {
        name: "Physics",
        papers: [
          { name: "1st Paper", chapters: Array.from({ length: 10 }, (_, i) => `Chapter ${i + 1}`) },
          { name: "2nd Paper", chapters: Array.from({ length: 10 }, (_, i) => `Chapter ${i + 1}`) },
        ],
        methods: ["Watch video", "Read books", "Take notes", "Solve typewise questions", "Read medical guide"],
      },
      {
        name: "Chemistry",
        papers: [
          { name: "1st Paper", chapters: Array.from({ length: 5 }, (_, i) => `Chapter ${i + 1}`) },
          { name: "2nd Paper", chapters: Array.from({ length: 5 }, (_, i) => `Chapter ${i + 1}`) },
        ],
        methods: ["Watch video", "Read books", "Take notes", "Solve typewise questions", "Read medical guide"],
      },
      {
        name: "Higher Maths",
        papers: [
          { name: "1st Paper", chapters: Array.from({ length: 10 }, (_, i) => `Chapter ${i + 1}`) },
          { name: "2nd Paper", chapters: Array.from({ length: 10 }, (_, i) => `Chapter ${i + 1}`) },
        ],
        methods: ["Watch video", "Solve problems", "Take subject-ending notes"],
      },
      {
        name: "ICT",
        papers: [{ name: "", chapters: Array.from({ length: 5 }, (_, i) => `Chapter ${i + 1}`) }],
        methods: ["Watch video", "Read main book", "Read guide book", "Practice"],
      },
    ];

    // Load and save data to localStorage
    const loadData = () => JSON.parse(localStorage.getItem("studyTrackerData")) || {};
    const saveData = (data) => localStorage.setItem("studyTrackerData", JSON.stringify(data));

    // Main App Component
    const App = () => {
      const [data, setData] = useState(loadData);
      const [currentSubject, setCurrentSubject] = useState(null);
      const [menuOpen, setMenuOpen] = useState(false);

      useEffect(() => {
        saveData(data);
      }, [data]);

      const toggleMethod = (subjectName, paperName, chapter, method) => {
        setData((prev) => {
          const newData = { ...prev };
          if (!newData[subjectName]) newData[subjectName] = {};
          if (!newData[subjectName][paperName]) newData[subjectName][paperName] = {};
          if (!newData[subjectName][paperName][chapter]) newData[subjectName][paperName][chapter] = { methods: {}, hours: 0 };
          newData[subjectName][paperName][chapter].methods[method] = !newData[subjectName][paperName][chapter].methods[method];
          return newData;
        });
      };

      const addHours = (subjectName, paperName, chapter, hours) => {
        const numHours = parseFloat(hours);
        if (isNaN(numHours) || numHours < 0) {
          alert("Please enter a valid number of hours.");
          return;
        }
        setData((prev) => {
          const newData = { ...prev };
          if (!newData[subjectName]) newData[subjectName] = {};
          if (!newData[subjectName][paperName]) newData[subjectName][paperName] = {};
          if (!newData[subjectName][paperName][chapter]) newData[subjectName][paperName][chapter] = { methods: {}, hours: 0 };
          newData[subjectName][paperName][chapter].hours += numHours;
          return newData;
        });
      };

      const resetProgress = () => {
        if (window.confirm("Are you sure you want to reset all progress?")) {
          setData({});
          localStorage.removeItem("studyTrackerData");
        }
      };

      const getTotalHours = (subjectName) => {
        if (!data[subjectName]) return 0;
        return Object.values(data[subjectName]).reduce((total, paper) => {
          return total + Object.values(paper).reduce((paperTotal, chapter) => paperTotal + (chapter.hours || 0), 0);
        }, 0);
      };

      const getMethodsCompleted = (subjectName, paperName, chapter, methods) => {
        if (!data[subjectName]?.[paperName]?.[chapter]?.methods) return 0;
        return methods.reduce((count, method) => count + (data[subjectName][paperName][chapter].methods[method] ? 1 : 0), 0);
      };

      if (currentSubject) {
        const subject = subjects.find((s) => s.name === currentSubject);
        return (
          <div className="container">
            <header className="header">
              <button onClick={() => setCurrentSubject(null)}>Back</button>
              <h1>StudySky</h1>
              <div></div>
            </header>
            <h2 className="subject-title">{subject.name}</h2>
            <p className="total-hours">Total Hours: {getTotalHours(subject.name).toFixed(2)}</p>
            {subject.papers.map((paper) => (
              <div key={paper.name} className="paper-section">
                {paper.name && <h3 className="paper-title">{paper.name}</h3>}
                {paper.chapters.map((chapter) => (
                  <div key={chapter} className="chapter-card">
                    <h4 className="chapter-title">{chapter}</h4>
                    <p>
                      Methods Completed: {getMethodsCompleted(subject.name, paper.name || subject.name, chapter, subject.methods)}/{subject.methods.length}
                    </p>
                    <div>
                      {subject.methods.map((method) => (
                        <label key={method} className="checkbox-label">
                          <input
                            type="checkbox"
                            checked={data[subject.name]?.[paper.name || subject.name]?.[chapter]?.methods?.[method] || false}
                            onChange={() => toggleMethod(subject.name, paper.name || subject.name, chapter, method)}
                          />
                          <span>{method}</span>
                        </label>
                      ))}
                    </div>
                    <div className="hours-section">
                      <input
                        type="number"
                        min="0"
                        step="0.1"
                        placeholder="Hours"
                        className="hours-input"
                        onKeyPress={(e) => {
                          if (e.key === "Enter") {
                            addHours(subject.name, paper.name || subject.name, chapter, e.target.value);
                            e.target.value = "";
                          }
                        }}
                      />
                      <span>Hours: {(data[subject.name]?.[paper.name || subject.name]?.[chapter]?.hours || 0).toFixed(2)}</span>
                    </div>
                  </div>
                ))}
              </div>
            ))}
          </div>
        );
      }

      return (
        <div className="container">
          <header className="header">
            <h1>StudySky</h1>
            <button className="menu-button" onClick={() => setMenuOpen(!menuOpen)}>
              {menuOpen ? "✖" : "☰"}
            </button>
            <div className="desktop-buttons">
              <button className="reset-button" onClick={resetProgress}>
                Reset Progress
              </button>
            </div>
          </header>
          {menuOpen && (
            <div className="menu-content">
              <button className="reset-button" onClick={resetProgress}>
                Reset Progress
              </button>
            </div>
          )}
          <div className="subject-grid">
            {subjects.map((subject) => {
              const totalHours = getTotalHours(subject.name);
              return (
                <div
                  key={subject.name}
                  className="subject-card"
                  onClick={() => setCurrentSubject(subject.name)}
                >
                  <h2>{subject.name}</h2>
                  <p className="total-hours">Total Hours: {totalHours.toFixed(2)}</p>
                  <div className="progress-bar">
                    <div
                      className="progress-fill"
                      style={{ width: `${Math.min((totalHours / 100) * 100, 100)}%` }}
                    ></div>
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      );
    };

    ReactDOM.render(<App />, document.getElementById("root"));
  </script>
</body>
</html>
